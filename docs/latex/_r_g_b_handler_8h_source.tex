\doxysection{RGBHandler.\+h}
\hypertarget{_r_g_b_handler_8h_source}{}\label{_r_g_b_handler_8h_source}\index{src/handler/RGBHandler.h@{src/handler/RGBHandler.h}}
\mbox{\hyperlink{_r_g_b_handler_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#ifndef\ RGBHANDLER\_H}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ RGBHANDLER\_H}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <Arduino.h>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <WS2812Serial.h>}\ \ \textcolor{comment}{//\ Library\ for\ controlling\ WS2812\ LEDs}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{comment}{//\ Forward\ declaration\ if\ EffectType\ is\ an\ enum\ defined\ elsewhere\ or\ define\ it\ here}}
\DoxyCodeLine{00018\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{_r_g_b_handler_8h_a4809a7bb3fd1a421902a667cc1405d43}{EffectType}}\ \{}
\DoxyCodeLine{00019\ \ \ \mbox{\hyperlink{_r_g_b_handler_8h_a4809a7bb3fd1a421902a667cc1405d43ac157bdf0b85a40d2619cbc8bc1ae5fe2}{NONE}},}
\DoxyCodeLine{00020\ \ \ \mbox{\hyperlink{_r_g_b_handler_8h_a4809a7bb3fd1a421902a667cc1405d43a6a0aa0c7f1e82444e7df71dfd7509cac}{PULSE}},}
\DoxyCodeLine{00021\ \ \ \mbox{\hyperlink{_r_g_b_handler_8h_a4809a7bb3fd1a421902a667cc1405d43a91d543a7c44452845529398ed3fdb1e8}{STREAK}},}
\DoxyCodeLine{00022\ \ \ \mbox{\hyperlink{_r_g_b_handler_8h_a4809a7bb3fd1a421902a667cc1405d43a1b45f84e1f6603b52e5ef442836df9af}{SOLID}}}
\DoxyCodeLine{00023\ \};\ \ \textcolor{comment}{//\ Assuming\ SOLID\ might\ be\ implicitly\ handled\ or\ needed}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{comment}{//\ Constants\ that\ might\ be\ defined\ in\ a\ config\ file\ or\ here\ for\ compilation}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#ifndef\ NUM\_SECTIONS}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#define\ NUM\_SECTIONS\ 3\ \ }\textcolor{comment}{//\ Example:\ Number\ of\ LED\ sections}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#ifndef\ TOTAL\_LEDS}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#define\ TOTAL\_LEDS\ 60\ \ }\textcolor{comment}{//\ Example:\ Total\ number\ of\ LEDs\ in\ the\ strip}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00032\ \textcolor{comment}{//\ Example\ SECTION\_SIZES,\ should\ match\ NUM\_SECTIONS}}
\DoxyCodeLine{00033\ \textcolor{keyword}{const}\ uint16\_t\ \mbox{\hyperlink{_r_g_b_handler_8h_a4d1158e07af709164e9265c35bf3a128}{SECTION\_SIZES}}[\mbox{\hyperlink{_r_g_b_handler_8h_a6974c83481090ea7dd3b9dc08f32ef1f}{NUM\_SECTIONS}}]\ =\ \{20,\ 20,\ 20\};\ \ \textcolor{comment}{//\ Example\ sizes}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ DEFAULT\_BRIGHTNESS\ 50\ \ }}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#define\ MAX\_BRIGHTNESS\ 150\ \ \ \ \ }}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#define\ DEFAULT\_SPEED\ 100\ \ \ \ \ \ }}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ MIN\_SPEED\ 10\ \ \ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#define\ MAX\_SPEED\ 1000\ \ \ \ \ \ \ \ \ }}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \{}
\DoxyCodeLine{00048\ \ \ uint8\_t\ \mbox{\hyperlink{struct_r_g_b_color_ae6252b419dd0b89457f4e7c0555a8c6f}{r}};\ \ }
\DoxyCodeLine{00049\ \ \ uint8\_t\ \mbox{\hyperlink{struct_r_g_b_color_aa2ab5bc0b96b7e6fb8d6fe378fbbd0a3}{g}};\ \ }
\DoxyCodeLine{00050\ \ \ uint8\_t\ \mbox{\hyperlink{struct_r_g_b_color_a8bad8b377867551b26caaaad9578e173}{b}};\ \ }
\DoxyCodeLine{00051\ \};}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00059\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_global_colors}{GlobalColors}}\ \{}
\DoxyCodeLine{00060\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \mbox{\hyperlink{namespace_global_colors_aca48d8d04eff0564759befabf22487cb}{GOLD}}\ =\ \{255,\ 180,\ 0\};\ \ \ \ \ }
\DoxyCodeLine{00061\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \mbox{\hyperlink{namespace_global_colors_adf845738938c0e637ebdfe976ed27af4}{PURPLE}}\ =\ \{170,\ 0,\ 255\};\ \ \ }
\DoxyCodeLine{00062\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \mbox{\hyperlink{namespace_global_colors_ad567bc62ca6d8296ebc9c559b0160972}{GREEN}}\ =\ \{0,\ 255,\ 0\};\ \ \ \ \ \ }
\DoxyCodeLine{00063\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \mbox{\hyperlink{namespace_global_colors_a51955c982e823da63b53ce11cd95e555}{CYAN}}\ =\ \{0,\ 255,\ 255\};\ \ \ \ \ }
\DoxyCodeLine{00064\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \mbox{\hyperlink{namespace_global_colors_a61c98afef143c1bc3454cf090be7b555}{RED}}\ =\ \{255,\ 0,\ 0\};\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00065\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \mbox{\hyperlink{namespace_global_colors_aebe441f7f8d496293fe6c53087dc00d5}{BLUE}}\ =\ \{0,\ 0,\ 255\};\ \ \ \ \ \ \ }
\DoxyCodeLine{00066\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \mbox{\hyperlink{namespace_global_colors_a99af0fe69bc40ee0d25c32c0fdda9f2a}{BLACK}}\ =\ \{0,\ 0,\ 0\};\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00067\ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \mbox{\hyperlink{namespace_global_colors_a1b525564b71e5ba1304197d1845cffa5}{WHITE}}\ =\ \{255,\ 255,\ 255\};\ \ }
\DoxyCodeLine{00068\ \}\ \ \textcolor{comment}{//\ namespace\ GlobalColors}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00078\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_r_g_b_handler_a62112ee2f17ea09f5dd79d0206f9f474}{RGBHandler}}\ \{}
\DoxyCodeLine{00079\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00080\ \ \ \mbox{\hyperlink{class_r_g_b_handler_a62112ee2f17ea09f5dd79d0206f9f474}{RGBHandler}}(uint8\_t\ kLED\_pin);\ \ \textcolor{comment}{//\ Renamed\ parameter\ for\ clarity}}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_g_b_handler_a77c0222072d69e6012ae6ea67d84ed81}{Begin}}();}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_g_b_handler_a3d3bca7f6766d3af74f196e37393d7bd}{Update}}();}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ Solid\ color\ effects}}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_g_b_handler_ab7dcb6eba515160f4ea06f1c277a59d1}{setSectionSolidColor}}(uint8\_t\ section,\ uint8\_t\ r,\ uint8\_t\ g,\ uint8\_t\ b);}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_g_b_handler_ab7dcb6eba515160f4ea06f1c277a59d1}{setSectionSolidColor}}(uint8\_t\ section,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \&color);}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \textcolor{comment}{//\ Pulse\ effects}}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_g_b_handler_a20ccadd3b616f42ac9c0fadcb67dd43a}{setSectionPulseEffect}}(uint8\_t\ section,\ uint8\_t\ r,\ uint8\_t\ g,\ uint8\_t\ b,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ speed);}
\DoxyCodeLine{00090\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_g_b_handler_a20ccadd3b616f42ac9c0fadcb67dd43a}{setSectionPulseEffect}}(uint8\_t\ section,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \&color,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ speed);}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \textcolor{comment}{//\ Streak\ effects\ (including\ reverse)}}
\DoxyCodeLine{00093\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_g_b_handler_a3ab7188affaf7bfa5c12cff31a27a6dd}{setSectionStreakEffect}}(uint8\_t\ section,\ uint8\_t\ r,\ uint8\_t\ g,\ uint8\_t\ b,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ speed,}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ reverse\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_g_b_handler_a3ab7188affaf7bfa5c12cff31a27a6dd}{setSectionStreakEffect}}(uint8\_t\ section,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_r_g_b_color}{RGBColor}}\ \&color,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ speed,}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ reverse\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \textcolor{comment}{//\ bool\ processCommand(const\ String\ \&command);\ //\ If\ implemented,\ needs\ definition}}
\DoxyCodeLine{00099\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_g_b_handler_aebf8a9e65ca09dc01c358aa8353d394e}{stopSectionEffect}}(uint8\_t\ section);}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_g_b_handler_a6fa31c123261fd15078fdddabc37d9bc}{stopAllEffects}}();}
\DoxyCodeLine{00101\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_r_g_b_handler_a211ecc77216b4bf845f8537632981a2e}{setGlobalBrightness}}(uint8\_t\ brightness);}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_r_g_b_handler_a3381afef986f547b682e1e4f44de9eb5}{PrintInfo}}(Print\ \&output,\ \textcolor{keywordtype}{bool}\ printConfig\ =\ \textcolor{keyword}{false})\ \textcolor{keyword}{const};}
\DoxyCodeLine{00104\ \ \ \textcolor{keyword}{friend}\ Print\ \&\mbox{\hyperlink{class_r_g_b_handler_a905e179934b8744fb7b9241cee21b373}{operator<<}}(Print\ \&output,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_r_g_b_handler_a62112ee2f17ea09f5dd79d0206f9f474}{RGBHandler}}\ \&handler);}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00107\ \ \ uint8\_t\ kLED\_pin\_private;\ \ }
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00115\ \ \ \textcolor{keyword}{struct\ }SectionEffect\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \mbox{\hyperlink{_r_g_b_handler_8h_a4809a7bb3fd1a421902a667cc1405d43}{EffectType}}\ currentEffect\ =\ \mbox{\hyperlink{_r_g_b_handler_8h_a4809a7bb3fd1a421902a667cc1405d43ac157bdf0b85a40d2619cbc8bc1ae5fe2}{NONE}};\ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ lastUpdate\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ effectSpeed\ =\ \mbox{\hyperlink{_r_g_b_handler_8h_afc945b2e8394478f97e2aabc7aebaf0e}{DEFAULT\_SPEED}};\ \ }
\DoxyCodeLine{00119\ \ \ \ \ uint8\_t\ base\_r,\ base\_g,\ base\_b;\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00120\ \ \ \ \ uint16\_t\ pulse\_phase\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00121\ \ \ \ \ uint16\_t\ pulse\_step\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordtype}{int}\ streak\_position\ =\ 0;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00123\ \ \ \ \ uint8\_t\ streak\_trailLength\ =\ 2;\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordtype}{bool}\ reverseStreak\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00125\ \ \ \};}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ SectionEffect\ sections[\mbox{\hyperlink{_r_g_b_handler_8h_a6974c83481090ea7dd3b9dc08f32ef1f}{NUM\_SECTIONS}}];\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00128\ \ \ uint16\_t\ sectionStarts[\mbox{\hyperlink{_r_g_b_handler_8h_a6974c83481090ea7dd3b9dc08f32ef1f}{NUM\_SECTIONS}}];\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00129\ \ \ uint8\_t\ globalBrightness\ =\ \mbox{\hyperlink{_r_g_b_handler_8h_ad27ad76d41bf29c6b9f95e8c41b86398}{DEFAULT\_BRIGHTNESS}};\ \ }
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//\ WS2812Serial\ requires\ DMA\ buffers.\ These\ must\ be\ sized\ correctly.}}
\DoxyCodeLine{00132\ \ \ \textcolor{comment}{//\ TOTAL\_LEDS\ *\ 3\ for\ GRB,\ TOTAL\_LEDS\ *\ 12\ for\ internal\ display\ buffer\ (check\ lib\ specifics)}}
\DoxyCodeLine{00133\ \ \ uint8\_t\ drawingMemory[\mbox{\hyperlink{_r_g_b_handler_8h_a0ccf2b3db9429897fc6aaeefa659c503}{TOTAL\_LEDS}}\ *\ 3];}
\DoxyCodeLine{00134\ \ \ \textcolor{keyword}{alignas}(4)\ uint8\_t}
\DoxyCodeLine{00135\ \ \ \ \ \ \ displayMemory[\mbox{\hyperlink{_r_g_b_handler_8h_a0ccf2b3db9429897fc6aaeefa659c503}{TOTAL\_LEDS}}\ *\ 12];\ \ \textcolor{comment}{//\ WS2812Serial\ often\ uses\ 12\ bytes\ per\ LED\ for\ its\ display}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ buffer.\ \`{}alignas(4)`\ or\ \`{}aligned(4)`\ for\ DMA.}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ WS2812Serial\ leds;\ \ }
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ prev\_positions[\mbox{\hyperlink{_r_g_b_handler_8h_a6974c83481090ea7dd3b9dc08f32ef1f}{NUM\_SECTIONS}}];\ \ }
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \textcolor{keywordtype}{void}\ applyBrightness(uint8\_t\ r\_in,\ uint8\_t\ g\_in,\ uint8\_t\ b\_in,\ uint8\_t\ \&r\_out,\ uint8\_t\ \&g\_out,}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint8\_t\ \&b\_out);}
\DoxyCodeLine{00144\ \ \ \textcolor{keywordtype}{void}\ updatePulse(uint8\_t\ section);}
\DoxyCodeLine{00145\ \ \ \textcolor{keywordtype}{void}\ updateStreak(uint8\_t\ section);}
\DoxyCodeLine{00146\ \};}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ RGBHANDLER\_H}}

\end{DoxyCode}
